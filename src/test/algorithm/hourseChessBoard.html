<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    /**
     * 1.åˆ›å»ºæ£‹ç›˜ chessBoard æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„
     * 2.å°†å½“å‰ä½ç½®è®¾ç½®ä¸ºå·²è®¿é—®ï¼Œç„¶åæ ¹æ®å½“å‰ä½ç½®ï¼Œè®¡ç®—ğŸ´è¿˜èƒ½èµ°å“ªäº›ä½ç½®ï¼Œ
     *      å¹¶æ”¾å…¥åˆ°ä¸€ä¸ªé›†åˆä¸­ï¼Œæœ€å¤šæœ‰8ä¸ªä½ç½®å¯ä»¥èµ°ï¼Œæ²¡èµ°ä¸€æ­¥ç”¨éå†è®°å½•ä¸€ä¸‹ å½“å‰ä½ç½®ä¸º step += 1
     * 3.éå†ä¸Šä¸€æ­¥é›†åˆæ±‡æ€»å­˜æ”¾çš„æ‰€æœ‰ä½ç½®ï¼Œçœ‹çœ‹å“ªä¸ªèƒ½èµ°ï¼Œèµ°é€šå°±ç»§ç»­ ï¼Œèµ°ä¸é€šå›æº¯
     * 4.åˆ¤æ–­æ˜¯å¦å®Œæˆäº†ä»»åŠ¡ step å’Œåº”è¯¥èµ°çš„æ­¥æ•°æ¯”è¾ƒ  æ£‹ç›˜ å®½é«˜ç›¸ä¹˜ - 1ï¼Œå¦‚æœæ²¡æœ‰è¾¾åˆ°è¿™ä¸ªæ•°é‡ï¼Œè¡¨ç¤ºæ²¡æœ‰
     *      å®Œæˆä»»åŠ¡ï¼Œå°†æ•´ä¸ªæ£‹ç›˜ç½® 0
     *
     * ä¸åŒçš„èµ°æ³•(ç­–ç•¥)ï¼Œä¼šå¾—åˆ°ä¸åŒçš„ç»“æœï¼Œæ•ˆç‡ä¹Ÿä¼šæœ‰å½±å“
     */

    let X = 6; // è¡¨ç¤ºæ£‹ç›˜çš„åˆ—æ•°
    let Y = 6; // è¡¨ç¤ºæ£‹ç›˜çš„è¡Œæ•°
    // æ ‡è®°æ£‹ç›˜çš„å„ä¸ªä½ç½®æ˜¯å¦è¢«è®¿é—®è¿‡
    let visited = []
    // æ£‹ç›˜çš„æ‰€æœ‰ä½ç½®éƒ½è¢«è®¿é—®
    let finished = false

    class Point{
        constructor(point = {}) {
            this.x = point.x
            this.y = point.y
        }
    }

    /**
     * æ ¹æ®å½“å‰çš„ä½ç½®ï¼Œè·å–ä¹‹åå¯ä»¥èµ°çš„ä½ç½®
     * @param curPoint
     */
    function next(curPoint) {
        let ps = []
        let p1 = new Point()
        // å‘å·¦ç§»åŠ¨ä¸¤åˆ— å‘ä¸Šç§»åŠ¨ä¸€è¡Œ å³ å‘å·¦èµ°ä¸€ä¸ªæ—¥å­— å¤§äºç­‰äº 0 è¡¨ç¤ºè¿˜åœ¨æ£‹ç›˜å†…
        // å·¦ä¸Š1  5
        if ((p1.x = curPoint.x - 2) >= 0 && (p1.y = curPoint.y - 1) >= 0) {
            ps.push(new Point(p1))
        }
        // å‘å·¦ä¸Š2èµ°ä¸€ä¸ªæ—¥ 6
        if ((p1.x = curPoint.x - 1) >= 0 && (p1.y = curPoint.y - 2) >= 0) {
            ps.push(new Point(p1))
        }
        // å³ä¸Š2 7
        if ((p1.x = curPoint.x + 1) < X && (p1.y = curPoint.y - 2) >= 0) {
            ps.push(new Point(p1))
        }
        // å³ä¸Š1 0
        if ((p1.x = curPoint.x + 2) < X && (p1.y = curPoint.y - 1) >= 0) {
            ps.push(new Point(p1))
        }
        // å³ä¸‹1  1
        if ((p1.x = curPoint.x + 2) < X && (p1.y = curPoint.y + 1) < Y) {
            ps.push(new Point(p1))
        }
        // å³ä¸‹2   2
        if ((p1.x = curPoint.x + 1) < X && (p1.y = curPoint.y + 2) < Y) {
            ps.push(new Point(p1))
        }
        // å·¦ä¸‹2  3
        if ((p1.x = curPoint.x - 1) >= 0 && (p1.y = curPoint.y + 2) < Y) {
            ps.push(new Point(p1))
        }
        // å·¦ä¸‹1  4
        if ((p1.x = curPoint.x - 2) >= 0 && (p1.y = curPoint.y + 1) < Y) {
            ps.push(new Point(p1))
        }
        return ps
    }
    // æ ¹æ®å½“å‰è¿™ä¸€æ­¥çš„æ‰€æœ‰çš„ä¸‹ä¸€æ­¥å¯é€‰çš„ä½ç½®ï¼Œè¿›è¡Œéé€’å‡æ’åº
    function sort(ps) {
        ps.sort((p1, p2) => {
            let ls1 = next(p1)
            let ls2 = next(p2)
            return ls1.length - ls2.length
        })
    }

    /**
     * éª‘å£«å‘¨æ¸¸é—®é¢˜çš„ç®—æ³•
     * @param chessBoard
     * @param row å½“å‰ä½ç½®çš„è¡Œ ä»0 å¼€å§‹
     * @param col åˆ— ä»0å¼€å§‹
     * @param step æ˜¯ç¬¬å‡ æ­¥ï¼Œåˆå§‹ä¸º 1
     */
    function traversalChessBoard(chessBoard, row, col, step){
        chessBoard[row][col] = step
        // row = 4 X = 8 col = 4 ----> 4 * 8 + 4
        visited[row * X + col] = true
        // è·å–å½“å‰ä½ç½®å¯ä»¥èµ°çš„ä¸‹ä¸€ä¸ªä½ç½®çš„é›†åˆ
        let point = new Point()
        point.x = col
        point.y = row
        let ps = next(point)
        // è´ªå¿ƒç®—æ³•ï¼Œé€‰ä¸‹ä¸€æ­¥çš„ä¸‹ä¸€æ­¥æœ€å°‘çš„å¤„ç†
        sort(ps)
        // å¯¹ ps ä¸­æ‰€æœ‰çš„pointçš„ä¸‹ä¸€ä¸ªæ‰€æœ‰é›†åˆçš„æ•°ç›®ï¼Œè¿›è¡Œéé€’å‡æ’åºï¼ˆå…è®¸é‡å¤ï¼‰
        while (ps.length) {
            let p = ps.shift() // å–å‡ºä¸‹ä¸€ä¸ªå¯ä»¥èµ°çš„ä½ç½®
            // åˆ¤æ–­è¯¥ç‚¹æ˜¯å¦å·²ç»è®¿é—®è¿‡
            if (!visited[p.y * X + p.x]) {
                // ++ step æ›´å¿« ä½†æ˜¯ä¼šæœ‰é‡å¤å€¼
                traversalChessBoard(chessBoard, p.y, p.x, step + 1)
            }
        }
        // å›æº¯
        // step < X * Y æˆç«‹çš„æƒ…å†µæœ‰ä¸¤ç§
        //  1.æ£‹ç›˜åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä»ç„¶æ²¡æœ‰èµ°å®Œ
        //  2.æ£‹ç›˜èµ°å®Œï¼Œå¤„äºå›æº¯è¿‡ç¨‹ä¸­
        if (step < X * Y && !finished) {
            chessBoard[row][col] = 0
            visited[row * X + col] = false
        } else {
            finished = true
        }
    }

    let row = 2 // åˆå§‹ä½ç½®çš„è¡Œ
    let col = 3
    // åˆ›å»ºæ£‹ç›˜
    let chessBoard = []
    for (let i = 0; i < X; i++) {
        chessBoard[i] = []
        for (let j = 0; j < Y; j++) {
          chessBoard[i][j] = 0
        }
    }
    for (let i = 0; i < X*Y; i++) {
        visited[i] = false
    }
    console.log(visited)
    let start = Date.now()
    traversalChessBoard(chessBoard, row - 1, col - 1, 1)
    console.log(`è€—æ—¶${Date.now() - start}`)
    // æ£‹ç›˜çš„æœ€åæƒ…å†µ
    console.log(chessBoard)

</script>
</body>
</html>